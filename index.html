<!DOCTYPE html>
<html
  lang="en"
  x-data="{ darkMode: $persist(window.matchMedia('(prefers-color-scheme: dark)').matches) }"
  :class="{ 'dark': darkMode }"
>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Section Schema UI | Shopify</title>

    <script src="https://unpkg.com/@alpinejs/persist@3.x.x/dist/cdn.min.js"></script>

    <script
      defer
      src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"
    ></script>

    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    <link href="/build/index.css" rel="stylesheet" />
  </head>

  <body x-data class="relative antialiased bg-white dark:bg-slate-900">
    <main>
      <div class="max-w-screen-xl px-4 sm:px-6 lg:px-8 py-12 mx-auto">
        <section>
          <div class="flex items-end justify-between">
            <div class="max-w-prose">
              <h1 class="text-3xl font-bold text-slate-900 dark:text-white">
                Section Schema UI for Shopify
              </h1>

              <p class="mt-4 text-slate-500 dark:text-slate-300">
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Eius
                omnis exercitationem minus obcaecati suscipit culpa earum ea
                consequuntur atque dolores, dolorem esse aspernatur, tenetur
                nesciunt vel optio quibusdam explicabo debitis!
              </p>
            </div>

            <button
              type="button"
              @click="darkMode = !darkMode"
              class="bg-slate-200 dark:bg-slate-700 dark:text-white"
            >
              <span x-show="darkMode" x-cloak> Light </span>

              <span x-show="!darkMode" x-cloak> Dark </span>
            </button>
          </div>
        </section>

        <section
          class="p-8 mt-8 border border-slate-100 bg-slate-50 dark:border-slate-700 dark:bg-slate-800 rounded-3xl"
        >
          <form @submit.prevent="$store.schema.update" class="flow-root">
            <div class="-my-8 divide-y divide-slate-100 dark:divide-slate-700">
              <fieldset class="grid grid-cols-1 gap-4 py-8 lg:grid-cols-3">
                <div>
                  <legend class="font-medium text-slate-900 dark:text-white">
                    <span role="img" class="mr-1.5"> üìá </span>

                    Details
                  </legend>

                  <p
                    class="mt-1 text-sm max-w-[40ch] text-slate-500 dark:text-slate-300"
                  >
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit.
                    Odio laudantium eaque quibusdam, obcaecati sint sunt.
                  </p>
                </div>

                <div
                  class="grid grid-cols-1 gap-4 lg:grid-cols-6 lg:col-span-2"
                >
                  <div class="lg:col-span-3">
                    <label for="details_name"> Name </label>

                    <input
                      type="text"
                      id="details_name"
                      x-model="$store.details.name"
                      @input="$store.schema.update"
                    />
                  </div>

                  <div class="lg:col-span-3">
                    <label for="details_class"> Class </label>

                    <input
                      type="text"
                      id="details_class"
                      x-model="$store.details.class"
                      @input="$store.schema.update"
                    />
                  </div>

                  <div class="lg:col-span-2">
                    <label for="details_tag"> Tag </label>

                    <select
                      id="details_tag"
                      x-model="$store.details.tag"
                      @change="$store.schema.update"
                    >
                      <option value="div">div</option>
                      <option value="section">section</option>
                      <option value="header">header</option>
                      <option value="footer">footer</option>
                      <option value="article">article</option>
                      <option value="aside">aside</option>
                    </select>
                  </div>

                  <div class="lg:col-span-2">
                    <label for="details_max_blocks"> Max Blocks </label>

                    <input
                      type="number"
                      id="details_max_blocks"
                      x-model="$store.details.max_blocks"
                      @input="$store.schema.update"
                    />
                  </div>
                </div>
              </fieldset>

              <fieldset class="grid grid-cols-1 gap-4 py-8 lg:grid-cols-3">
                <div>
                  <legend class="font-medium text-slate-900 dark:text-white">
                    <span role="img" class="mr-1.5"> üêô </span>

                    Settings
                  </legend>

                  <p
                    class="mt-1 text-sm max-w-[40ch] text-slate-500 dark:text-slate-300"
                  >
                    Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                    Non, quod beatae voluptates possimus recusandae dolor!
                  </p>
                </div>

                <div
                  class="grid grid-cols-1 gap-4 lg:grid-cols-6 lg:col-span-2"
                >
                  <template x-if="$store.schema.show('id')">
                    <div class="lg:col-span-3">
                      <label for="setting_id">ID</label>
                      <input
                        type="text"
                        id="setting_id"
                        x-model="$store.settings.item.id"
                      />
                    </div>
                  </template>

                  <div class="lg:col-span-3">
                    <label for="setting_type">Type</label>
                    <select
                      id="setting_type"
                      x-model="$store.settings.item.type"
                    >
                      <option value="text">text</option>
                      <option value="textarea">textarea</option>
                      <option value="number">number</option>
                      <option value="checkbox">checkbox</option>
                      <option value="radio">radio</option>
                      <option value="range">range</option>
                      <option value="select">select</option>
                      <option value="article">article</option>
                      <option value="blog">blog</option>
                      <option value="collection">collection</option>
                      <option value="color">color</option>
                      <option value="font_picker">font picker</option>
                      <option value="html">html</option>
                      <option value="image_picker">image picker</option>
                      <option value="link_list">link list</option>
                      <option value="liquid">liquid</option>
                      <option value="richtext">richtext</option>
                      <option value="url">url</option>
                      <option value="video_url">video url</option>
                      <option value="header">header</option>
                    </select>
                  </div>

                  <template x-if="$store.schema.show('label')">
                    <div class="lg:col-span-3">
                      <label for="setting_label">Label</label>
                      <input
                        type="text"
                        id="setting_label"
                        x-model="$store.settings.item.label"
                      />
                    </div>
                  </template>

                  <template x-if="$store.schema.show('placeholder')">
                    <div class="lg:col-span-3">
                      <label for="setting_placeholder">Placeholder</label>
                      <input
                        type="text"
                        id="setting_placeholder"
                        x-model="$store.settings.item.placeholder"
                      />
                    </div>
                  </template>

                  <template x-if="$store.schema.show('content')">
                    <div class="lg:col-span-3">
                      <label for="setting_content">Content</label>
                      <input
                        type="text"
                        id="setting_content"
                        x-model="$store.settings.item.content"
                      />
                    </div>
                  </template>

                  <template x-if="$store.schema.show('default')">
                    <div class="lg:col-span-6">
                      <label for="setting_default">Default</label>
                      <textarea
                        id="setting_default"
                        rows="4"
                        x-model="$store.settings.item.default"
                      >
                      </textarea>

                      <template x-if="$store.settings.item.type === 'html'">
                        <p class="mt-1 text-sm text-gray-500">
                          <span role="img"> üí° </span>

                          Remember to wrap your content in HTML tags
                        </p>
                      </template>

                      <template x-if="$store.settings.item.type === 'liquid'">
                        <p class="mt-1 text-sm text-gray-500">
                          <span role="img"> üí° </span>

                          Remember to wrap your content in Liquid tags
                        </p>
                      </template>
                    </div>
                  </template>

                  <template x-if="$store.schema.show('info')">
                    <div class="lg:col-span-6">
                      <label for="setting_info">Info</label>
                      <textarea
                        id="setting_info"
                        rows="4"
                        x-model="$store.settings.item.info"
                      >
                      </textarea>
                    </div>
                  </template>

                  <template x-if="$store.settings.item.type === 'video_url'">
                    <div class="lg:col-span-6">
                      <p
                        class="text-sm font-medium text-slate-900 dark:text-white"
                      >
                        Accept
                      </p>

                      <div class="mt-4 space-y-2">
                        <div>
                          <label
                            for="setting_accept_vimeo"
                            class="flex items-center"
                          >
                            <input
                              id="setting_accept_vimeo"
                              type="checkbox"
                              value="vimeo"
                              x-model="$store.settings.item.accept"
                            />

                            <span
                              class="ml-1.5 text-sm text-slate-900 dark:text-white"
                            >
                              Vimeo
                            </span>
                          </label>
                        </div>

                        <div>
                          <label
                            for="setting_accept_youtube"
                            class="flex items-center"
                          >
                            <input
                              id="setting_accept_youtube"
                              type="checkbox"
                              value="youtube"
                              x-model="$store.settings.item.accept"
                            />

                            <span
                              class="ml-1.5 text-sm text-slate-900 dark:text-white"
                            >
                              YouTube
                            </span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </template>

                  <template x-if="$store.settings.item.type === 'range'">
                    <div class="lg:col-span-6">
                      <p
                        class="text-sm font-medium text-slate-900 dark:text-white"
                      >
                        Range
                      </p>

                      <div class="grid grid-cols-1 gap-4 mt-4 lg:grid-cols-6">
                        <div class="lg:col-span-3">
                          <label for="setting_min">Min</label>
                          <input
                            type="number"
                            id="setting_min"
                            x-model="$store.settings.item.min"
                          />
                        </div>

                        <div class="lg:col-span-3">
                          <label for="setting_max">Max</label>
                          <input
                            type="number"
                            id="setting_max"
                            x-model="$store.settings.item.max"
                          />
                        </div>

                        <div class="lg:col-span-3">
                          <label for="setting_step">Step</label>
                          <input
                            type="number"
                            id="setting_step"
                            x-model="$store.settings.item.step"
                          />
                        </div>

                        <div class="lg:col-span-3">
                          <label for="setting_unit">Unit</label>
                          <select
                            id="setting_unit"
                            x-model="$store.settings.item.unit"
                          >
                            <option value="px">px</option>
                            <option value="rem">rem</option>
                            <option value="em">em</option>
                            <option value="%">%</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </template>

                  <template
                    x-if="['radio', 'select'].includes($store.settings.item.type)"
                  >
                    <div class="lg:col-span-6">
                      <p
                        class="text-sm font-medium text-slate-900 dark:text-white"
                      >
                        Options
                      </p>

                      <div class="grid grid-cols-1 gap-4 mt-4 lg:grid-cols-6">
                        <div class="lg:col-span-3">
                          <label for="option_label">Label</label>

                          <input
                            type="text"
                            id="option_label"
                            x-model="$store.options.item.label"
                          />
                        </div>

                        <div class="lg:col-span-3">
                          <label for="option_value">Value</label>

                          <input
                            type="text"
                            id="option_value"
                            x-model="$store.options.item.value"
                          />
                        </div>

                        <template x-if="$store.settings.item.type === 'select'">
                          <div class="lg:col-span-3">
                            <label for="option_group">Group</label>

                            <input
                              type="text"
                              id="option_group"
                              x-model="$store.options.item.group"
                            />
                          </div>
                        </template>
                      </div>

                      <template x-if="$store.options.items.length > 0">
                        <div class="flow-root mt-4">
                          <ul class="flex flex-wrap -m-1">
                            <template
                              x-for="(option, index) in $store.options.items"
                            >
                              <li class="p-1">
                                <strong
                                  class="inline-flex items-center px-3 py-1 border border-slate-200/50 bg-slate-100/50 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-full"
                                >
                                  <span
                                    class="text-xs font-medium text-slate-700 dark:text-slate-300"
                                    x-text="option.label"
                                  ></span>

                                  <button
                                    type="button"
                                    class="w-5 h-5 p-0 rounded-full"
                                    @click="$store.options.remove(index)"
                                  >
                                    <span role="img" class="ml-0"> üóë </span>
                                  </button>
                                </strong>
                              </li>
                            </template>
                          </ul>
                        </div>
                      </template>

                      <button
                        type="button"
                        @click="$store.options.add"
                        class="bg-violet-600 hover:scale-105 text-white transition mt-4"
                      >
                        Add Option

                        <span role="img"> ü§î </span>
                      </button>
                    </div>
                  </template>

                  <div class="lg:col-span-6">
                    <label for="target"> Block </label>

                    <select id="target" x-model="$store.block">
                      <option> Please Select </option>

                      <template x-for="block in $store.blocks.items">
                        <option
                          :value="block.name"
                          x-text="block.name"
                        ></option>
                      </template>
                    </select>
                  </div>

                  <div class="lg:col-span-6">
                    <button
                      type="button"
                      @click="$store.settings.add"
                      class="bg-violet-600 hover:scale-105 text-white transition"
                    >
                      Add Setting

                      <span role="img"> ü•≥ </span>
                    </button>
                  </div>
                </div>
              </fieldset>

              <fieldset class="grid grid-cols-1 gap-4 py-8 lg:grid-cols-3">
                <div>
                  <legend class="font-medium text-slate-900 dark:text-white">
                    <span role="img" class="mr-1.5"> üüß </span>

                    Blocks
                  </legend>

                  <p
                    class="mt-1 text-sm max-w-[40ch] text-slate-500 dark:text-slate-300"
                  >
                    Lorem ipsum dolor sit amet consectetur adipisicing elit.
                    Error tempora ea quo doloremque aperiam ad!
                  </p>
                </div>

                <div
                  class="grid grid-cols-1 gap-4 lg:grid-cols-6 lg:col-span-2"
                >
                  <div class="lg:col-span-3">
                    <label for="block_name"> Name </label>

                    <input
                      type="text"
                      id="block_name"
                      x-model="$store.blocks.item.name"
                    />
                  </div>

                  <div class="lg:col-span-3">
                    <label for="block_type"> Type </label>

                    <input
                      type="text"
                      id="block_type"
                      x-model="$store.blocks.item.type"
                    />
                  </div>

                  <div class="lg:col-span-3">
                    <label for="block_limit"> Limit </label>

                    <input
                      type="number"
                      id="block_limit"
                      x-model="$store.blocks.item.limit"
                    />
                  </div>

                  <div class="lg:col-span-6">
                    <button
                      type="button"
                      @click="$store.blocks.add"
                      class="bg-violet-600 hover:scale-105 text-white transition"
                    >
                      Add Block

                      <span role="img"> üß± </span>
                    </button>
                  </div>
                </div>
              </fieldset>

              <div x-data="{ show: false }">
                <div class="grid grid-cols-1 gap-4 py-8 lg:grid-cols-3">
                  <div>
                    <p class="font-medium text-slate-900 dark:text-white">
                      <span role="img" class="mr-1.5"> ü¶æ </span>

                      Enhanced Features
                    </p>

                    <p
                      class="mt-1 text-sm max-w-[40ch] text-slate-500 dark:text-slate-300"
                    >
                      Lorem ipsum dolor sit amet, consectetur adipisicing elit.
                      Voluptate, cupiditate?
                    </p>
                  </div>

                  <div class="space-y-8 lg:col-span-2">
                    <fieldset
                      class="p-8 bg-slate-100 border border-slate-200 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                    >
                      <div>
                        <legend
                          class="font-medium text-slate-900 dark:text-white"
                        >
                          <span role="img" class="mr-1.5"> üåÄ </span>

                          Presets
                        </legend>

                        <p
                          class="mt-1 text-sm max-w-[40ch] text-slate-500 dark:text-slate-300"
                        >
                          Lorem ipsum dolor sit amet, consectetur adipisicing
                          elit. Voluptate, cupiditate?
                        </p>
                      </div>

                      <div class="grid grid-cols-1 gap-4 mt-4 lg:grid-cols-6">
                        <div class="lg:col-span-3">
                          <label for="preset_name"> Name </label>

                          <input
                            type="text"
                            id="preset_name"
                            x-model="$store.presets.item.name"
                          />
                        </div>

                        <div class="lg:col-span-6">
                          <template x-if="$store.presets.items.length === 0">
                            <button
                              type="button"
                              @click="$store.presets.add"
                              class="bg-violet-600 hover:scale-105 text-white transition"
                            >
                              Add Preset

                              <span role="img"> üê≥ </span>
                            </button>
                          </template>

                          <template x-if="$store.presets.items.length !== 0">
                            <button
                              type="button"
                              @click="$store.presets.remove"
                              class="bg-violet-600 hover:scale-105 text-white transition"
                            >
                              Remove Preset

                              <span role="img"> üëã </span>
                            </button>
                          </template>
                        </div>
                      </div>
                    </fieldset>

                    <fieldset
                      class="p-8 bg-slate-100 border border-slate-200 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                    >
                      <div>
                        <legend
                          class="font-medium text-slate-900 dark:text-white"
                        >
                          <span role="img" class="mr-1.5"> üåé </span>

                          Locales
                        </legend>

                        <p
                          class="mt-1 text-sm max-w-[40ch] text-slate-500 dark:text-slate-300"
                        >
                          Lorem ipsum dolor sit amet, consectetur adipisicing
                          elit. Voluptate, cupiditate?
                        </p>
                      </div>

                      <div class="grid grid-cols-1 gap-4 mt-4 lg:grid-cols-6">
                        <div class="lg:col-span-3">
                          <label for="translation_lang"> Language </label>

                          <input
                            type="text"
                            id="translation_lang"
                            x-model="$store.locales.item.lang"
                          />
                        </div>

                        <div class="lg:col-span-3">
                          <label for="translate_setting"> Setting </label>

                          <select
                            id="translate_setting"
                            x-model="$store.locales.item.setting"
                          >
                            <option>Please Select</option>

                            <template x-if="$store.settings.items">
                              <template
                                x-for="setting in $store.settings.items"
                              >
                                <option
                                  :value="setting.id"
                                  x-text="setting.label"
                                ></option>
                              </template>
                            </template>
                          </select>
                        </div>

                        <div class="lg:col-span-3">
                          <label for="translate_value"> Value </label>

                          <input
                            type="text"
                            id="translate_value"
                            x-model="$store.locales.item.value"
                          />
                        </div>

                        <div class="lg:col-span-6">
                          <button
                            type="button"
                            @click="$store.locales.add"
                            class="bg-violet-600 hover:scale-105 text-white transition"
                          >
                            Add Translation

                            <span role="img"> üó£ </span>
                          </button>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                </div>
              </div>

              <div class="grid grid-cols-1 gap-4 py-8 lg:grid-cols-3">
                <div class="space-y-8">
                  <div>
                    <p class="font-medium text-slate-900 dark:text-white">
                      Settings
                    </p>

                    <template
                      x-if="!$store.settings.items || $store.settings.items.length === 0"
                    >
                      <p
                        class="mt-1 text-sm text-slate-500 dark:text-slate-300"
                      >
                        Nothing to see here...
                      </p>
                    </template>

                    <ul class="mt-4 space-y-4">
                      <template
                        x-for="(setting, index) in $store.settings.items"
                      >
                        <li
                          x-data="{ show: false }"
                          class="p-4 border border-slate-200/50 bg-slate-100/50 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                        >
                          <div class="flex items-center justify-between">
                            <span
                              x-text="setting.label"
                              class="text-sm font-medium text-slate-700 dark:text-slate-200"
                            >
                            </span>

                            <div class="flex items-center space-x-1.5">
                              <button
                                type="button"
                                class="px-1.5 py-1 text-xs bg-blue-600 text-white hover:scale-105 transition rounded"
                                @click="show = !show"
                              >
                                Manage
                              </button>

                              <button
                                type="button"
                                class="px-1.5 py-1 text-xs bg-red-600 text-white transition hover:scale-105 rounded"
                                @click="$store.settings.remove(index)"
                              >
                                Remove
                              </button>
                            </div>
                          </div>

                          <div x-show="show" class="mt-4 space-y-4">
                            <div
                              class="p-4 border border-slate-200/50 bg-slate-100/50 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                            >
                              <label text-slate-500 dark:text-slate-300>
                                Move
                              </label>

                              <select
                                @change="$store.settings.move(index, $event.target.value)"
                              >
                                <option value="">Please Select</option>
                                <template x-for="block in $store.blocks.items">
                                  <option
                                    :value="block.name"
                                    x-text="block.name"
                                  ></option>
                                </template>
                              </select>
                            </div>

                            <template x-if="$store.locales.any(setting)">
                              <div
                                class="p-4 border border-slate-200/50 bg-slate-100/50 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                              >
                                <p
                                  class="text-sm font-medium text-slate-900 dark:text-white"
                                >
                                  Locales
                                </p>

                                <ul class="mt-1.5 space-y-1.5">
                                  <template
                                    x-for="(value, key) in $store.locales.translations(setting)"
                                  >
                                    <li
                                      class="flex items-center justify-between"
                                    >
                                      <span
                                        x-text="value[setting.id]"
                                        class="text-xs font-medium text-slate-500 dark:text-slate-300"
                                      ></span>

                                      <div
                                        class="flex items-center space-x-1.5"
                                      >
                                        <span
                                          x-text="key"
                                          class="px-1.5 py-1 text-xs font-medium rounded bg-blue-600 text-white hover:scale-105 transition"
                                        ></span>

                                        <button
                                          type="button"
                                          @click="$store.locales.remove(key, setting)"
                                          class="px-1.5 py-1 text-xs bg-red-600 text-white hover:scale-105 transition rounded"
                                        >
                                          Remove
                                        </button>
                                      </div>
                                    </li>
                                  </template>
                                </ul>
                              </div>
                            </template>
                          </div>
                        </li>
                      </template>
                    </ul>
                  </div>

                  <div>
                    <p class="font-medium text-slate-900 dark:text-white">
                      Blocks
                    </p>

                    <template
                      x-if="!$store.blocks.items || $store.blocks.items.length === 0"
                    >
                      <p
                        class="mt-1 text-sm text-slate-500 dark:text-slate-300"
                      >
                        Nothing to see here...
                      </p>
                    </template>

                    <ul class="mt-4 space-y-4">
                      <template x-for="(block, index) in $store.blocks.items">
                        <li
                          class="p-4 border border-slate-200/50 bg-slate-100/50 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                        >
                          <div class="flex items-center justify-between">
                            <span
                              x-text="block.name"
                              class="text-sm font-medium text-slate-700 dark:text-slate-200"
                            >
                            </span>

                            <button
                              type="button"
                              @click="$store.blocks.remove(index)"
                              class="px-1.5 py-1 text-xs bg-red-600 text-white hover:scale-105 transition rounded"
                            >
                              Remove
                            </button>
                          </div>

                          <template
                            x-if="block.settings && block.settings.length > 0"
                          >
                            <ul
                              class="p-4 mt-4 border border-slate-200/50 bg-slate-100/50 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                            >
                              <template
                                x-for="(setting, index) in block.settings"
                              >
                                <li x-data="{ show: false }">
                                  <div
                                    class="flex items-center justify-between"
                                  >
                                    <span
                                      x-text="setting.label"
                                      class="text-sm font-medium text-slate-700 dark:text-slate-200"
                                    >
                                    </span>

                                    <div class="flex items-center space-x-1.5">
                                      <button
                                        type="button"
                                        @click="show = !show"
                                        class="px-1.5 py-1 text-xs bg-blue-600 text-white hover:scale-105 transition rounded"
                                      >
                                        Manage
                                      </button>

                                      <button
                                        type="button"
                                        @click="$store.settings.remove(index, block.name)"
                                        class="px-1.5 py-1 text-xs bg-red-600 text-white hover:scale-105 transition rounded"
                                      >
                                        Remove
                                      </button>
                                    </div>
                                  </div>

                                  <div x-show="show" class="mt-4 space-y-4">
                                    <div
                                      class="p-4 border border-slate-200/50 bg-slate-100/50 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                                    >
                                      <label> Move </label>

                                      <select
                                        @change="$store.settings.move(index, $event.target.value, block.name)"
                                      >
                                        <option>Please Select</option>
                                        <option value="settings">
                                          Settings
                                        </option>

                                        <template
                                          x-for="item in $store.blocks.items"
                                        >
                                          <template
                                            x-if="item.name !== block.name"
                                          >
                                            <option
                                              :value="item.name"
                                              x-text="item.name"
                                            >
                                            </option>
                                          </template>
                                        </template>
                                      </select>
                                    </div>

                                    <template
                                      x-if="$store.locales.any(setting)"
                                    >
                                      <div
                                        class="p-2 bg-slate-100 border border-slate-200 dark:border-slate-800 dark:bg-slate-700 rounded-lg"
                                      >
                                        <p class="text-sm font-medium">
                                          Locales
                                        </p>

                                        <ul class="mt-1.5 space-y-1.5">
                                          <template
                                            x-for="(translation, lang) in $store.locales.translations(setting)"
                                          >
                                            <li
                                              class="flex items-center justify-between"
                                            >
                                              <span
                                                x-text="translation[setting.id]"
                                                class="text-xs font-medium text-slate-500 dark:text-slate-300"
                                              ></span>

                                              <div
                                                class="flex items-center space-x-1.5"
                                              >
                                                <span
                                                  x-text="lang"
                                                  class="px-1.5 py-1 text-xs font-medium rounded bg-blue-600 text-white hover:scale-105 transition"
                                                ></span>

                                                <button
                                                  type="button"
                                                  @click="$store.locales.remove(lang, setting.id)"
                                                  class="px-1.5 py-1 text-xs bg-red-600 text-white hover:scale-105 transition rounded"
                                                >
                                                  Remove
                                                </button>
                                              </div>
                                            </li>
                                          </template>
                                        </ul>
                                      </div>
                                    </template>
                                  </div>
                                </li>
                              </template>
                            </ul>
                          </template>
                        </li>
                      </template>
                    </ul>
                  </div>
                </div>

                <div class="relative lg:col-span-2">
                  <textarea
                    rows="15"
                    id="textarea"
                    x-text="JSON.stringify($store.schema.data, null, 2)"
                    class="block font-mono h-full bg-slate-100 border border-slate-200 dark:border-slate-800/50 dark:bg-slate-900/50 rounded-lg"
                  ></textarea>

                  <button
                    type="button"
                    @click="$store.schema.copy"
                    class="bg-violet-600 hover:scale-105 text-white transition absolute bottom-4 right-4"
                  >
                    Copy to Clipboard

                    <span role="img"> üìã </span>
                  </button>
                </div>
              </div>
            </div>

            <button
              type="submit"
              class="bg-violet-600 hover:scale-105 text-white transition fixed right-4 bottom-4"
            >
              Save Form

              <span role="img"> üëå </span>
            </button>
          </form>
        </section>
      </div>
    </main>

    <script>
      document.addEventListener('alpine:init', () => {
        Alpine.store('details', {
          max_blocks: Alpine.$persist('').as('detailsMaxBlocks'),
          tag: Alpine.$persist('section').as('detailsTag'),
          name: Alpine.$persist('Shopify Section').as('detailsName'),
          class: Alpine.$persist('shopify-section').as('detailsClass'),
        })
      })
    </script>

    <script>
      const DEFAULT_SETTING = {
        id: 'message',
        type: 'text',
        label: 'Message',
        default: '',
        placeholder: '',
        info: '',
        min: '',
        max: '',
        step: '',
        unit: '',
        options: [],
        accept: [],
      }

      document.addEventListener('alpine:init', () => {
        Alpine.store('settings', {
          items: Alpine.$persist([]).as('settingItems'),
          item: Alpine.$persist({ ...DEFAULT_SETTING }).as('settingItem'),

          add() {
            const options = Alpine.store('options').items
            const blocks = Alpine.store('blocks').items
            const selectedBlock = Alpine.store('block')
            const setting = self.item

            let newSetting = (options.length > 0 && {
              ...setting,
              options: [...options],
            }) || { ...setting }
            newSetting = _.omitBy(newSetting, _.isEmpty)

            if (selectedBlock) {
              const block = _.find(blocks, { name: selectedBlock })
              const { settings: blockSettings } = block
              const newBlockSettings = (blockSettings &&
                blockSettings.length > 0 && [...blockSettings, newSetting]) || [
                newSetting,
              ]

              block.settings = newBlockSettings

              Alpine.store('block', '')
            } else {
              self.items = [...self.items, newSetting]
            }

            self.item = { ...DEFAULT_SETTING }

            Alpine.store('schema').update()
          },

          remove(index, block) {
            const blocks = Alpine.store('blocks').items

            if (block) {
              const currentBlock = _.find(blocks, { name: block })
              const newBlockSettings = _.filter(
                currentBlock.settings,
                (item, itemIndex) => itemIndex !== index
              )

              currentBlock.settings = newBlockSettings
            } else {
              const newSettings = _.filter(
                self.items,
                (item, itemIndex) => itemIndex !== index
              )
              self.items = newSettings
            }

            Alpine.store('schema').update()
          },

          move(index, value, block = false) {
            const blocks = Alpine.store('blocks').items
            const isSettings = value === 'settings'
            const currentBlock = isSettings
              ? _.find(blocks, { name: block })
              : _.find(blocks, { name: value })

            if (isSettings) {
              const currentSetting = currentBlock.settings[index]

              self.items = [...self.items, currentSetting]
              currentBlock.settings = _.filter(
                currentBlock.settings,
                (item, itemIndex) => itemIndex !== index
              )
            } else {
              const currentSetting = self.items[index]
              const currentBlockSettings = currentBlock.settings
              const newCurrentBlockSettings = (currentBlockSettings &&
                currentBlockSettings.length > 0 && [
                  ...currentBlockSettings,
                  currentSetting,
                ]) || [currentSetting]

              currentBlock.settings = newCurrentBlockSettings
              self.items = _.filter(
                self.items,
                (item, itemIndex) => itemIndex !== index
              )
            }

            Alpine.store('schema').update()
          },
        })

        const self = Alpine.store('settings')
      })
    </script>

    <script>
      const DEFAULT_OPTION = {
        value: '',
        label: '',
        group: '',
      }

      document.addEventListener('alpine:init', () => {
        Alpine.store('options', {
          items: Alpine.$persist([]).as('optionsItems'),
          item: Alpine.$persist({ ...DEFAULT_OPTION }).as('optionsItem'),

          add() {
            let newItem = self.item
            newItem = _.omitBy(newItem, _.isEmpty)

            const newItems = (self.items && [...self.items, newItem]) || [
              newItem,
            ]

            self.items = newItems
            self.item = { ...DEFAULT_OPTION }
          },

          remove(index) {
            const newItems = _.filter(
              self.items,
              (item, itemIndex) => itemIndex !== index
            )

            self.items = newItems
          },
        })

        const self = Alpine.store('options')
      })
    </script>

    <script>
      const DEFAULT_BLOCK = {
        name: '',
        type: '',
        limit: '',
        settings: [],
      }

      document.addEventListener('alpine:init', () => {
        Alpine.store('blocks', {
          items: Alpine.$persist([]).as('blocksItems'),
          item: Alpine.$persist({ ...DEFAULT_BLOCK }).as('blocksItem'),

          add() {
            const { type } = self.item
            const types = _.map(self.items, 'type')

            if (types.includes(type)) return

            let newBlock = self.item
            newBlock = _.omitBy(newBlock, _.isEmpty)

            const newItems = (self.items && [...self.items, newBlock]) || [
              newBlock,
            ]

            self.items = newItems
            self.item = { ...DEFAULT_BLOCK }

            Alpine.store('schema').update()
          },

          remove(index) {
            const newItems = _.find(self.items, [], [index])

            self.items = newItems

            Alpine.store('schema').update()
          },
        })

        const self = Alpine.store('blocks')
      })
    </script>

    <script>
      document.addEventListener('alpine:init', () => {
        Alpine.store('block', '')
      })
    </script>

    <script>
      document.addEventListener('alpine:init', () => {
        Alpine.store('presets', {
          items: Alpine.$persist([]).as('presetsItems'),
          item: Alpine.$persist({ name: '' }).as('presetsItem'),

          add() {
            const newItems = (self.items && [...self.items, self.item]) || [
              self.item,
            ]

            self.items = newItems

            Alpine.store('schema').update()
          },

          remove() {
            self.items = []

            Alpine.store('schema').update()
          },
        })

        const self = Alpine.store('presets')
      })
    </script>

    <script>
      const DEFAULT_TRANSLATION = {
        lang: '',
        value: '',
        setting: '',
      }

      document.addEventListener('alpine:init', () => {
        Alpine.store('locales', {
          items: Alpine.$persist([]).as('localesItems'),
          item: Alpine.$persist({ ...DEFAULT_TRANSLATION }).as('localesItem'),

          add() {
            const { lang, setting, value } = self.item
            const locale = self.items[lang] || {}
            const newLocale = { ...locale, [setting]: value }

            self.items = { ...self.items, [lang]: newLocale }
            self.item = { ...DEFAULT_TRANSLATION }

            Alpine.store('schema').update()
          },

          remove(key, setting) {
            const { id } = setting
            const locale = self.items[key]
            const newLocale = _.pickBy(locale, (value, key) => key !== id)

            let newItems = { ...self.items, [key]: newLocale }

            newItems = _.keys(newLocale).length === 0 && _.omit(self.items, key)

            self.items = newItems

            Alpine.store('schema').update()
          },

          translations(setting) {
            const { id } = setting
            const keys = _.keys(self.items)
            const translations = _.pick(self.items, [...keys, id])

            return translations
          },

          any(setting) {
            const { id } = setting
            const translations = self.translations(id)

            return _.keys(translations).length > 0
          },
        })

        const self = Alpine.store('locales')
      })
    </script>

    <script>
      document.addEventListener('alpine:init', () => {
        Alpine.store('schema', {
          data: {},

          update() {
            const {
              name,
              tag,
              max_blocks,
              class: className,
            } = Alpine.store('details')
            const { items: settings } = Alpine.store('settings')
            const { items: blocks } = Alpine.store('blocks')
            const { items: presets } = Alpine.store('presets')
            const { items: locales } = Alpine.store('locales')

            let schemaData = {
              name,
              tag,
              max_blocks,
              class: className,
              settings,
              blocks,
              presets,
              locales,
            }

            schemaData = _.omitBy(schemaData, _.isEmpty)

            if (schemaData.max_blocks)
              schemaData.max_blocks = _.toInteger(schemaData.max_blocks)

            if (schemaData.settings && schemaData.settings.length > 0) {
              schemaData.settings.forEach((setting, index) => {
                const newSetting = setValues(setting)

                schemaData.settings[index] = newSetting
              })
            }

            if (schemaData.blocks && schemaData.blocks.length > 0) {
              schemaData.blocks.forEach((block, index) => {
                if (block.limit) block.limit = _.toInteger(block.limit)

                if (block.settings && block.settings.length > 0) {
                  block.settings.forEach((setting) => {
                    const newSetting = setValues(setting)

                    block.settings[index] = newSetting
                  })
                }
              })
            }

            self.data = schemaData
          },

          settings() {
            const { items: settings } = Alpine.store('settings')
            const { items: blocks } = Alpine.store('blocks')
            const blockSettings = _.flatMap(blocks, (block) => block.settings)

            return [...settings, ...blockSettings]
          },

          copy() {
            const textarea = document.getElementById('textarea')

            textarea.select()
            document.execCommand('copy')
          },

          show(input) {
            const { item: setting } = Alpine.store('settings')
            const { type } = setting
            const BASE_INPUTS = ['id', 'label', 'info']

            let showFields = [...BASE_INPUTS]

            switch (type) {
              case 'text':
              case 'textarea':
              case 'number':
                showFields = [...showFields, 'placeholder', 'default']
                break
              case 'checkbox':
              case 'radio':
              case 'color':
              case 'font_picker':
              case 'html':
              case 'liquid':
              case 'richtext':
                showFields = [...showFields, 'default']
                break
              case 'range':
                showFields = [
                  ...showFields,
                  'min',
                  'max',
                  'step',
                  'unit',
                  'default',
                ]
                break
              case 'select':
                showFields = [...showFields, 'options', 'default']
                break
              case 'video_url':
                showFields = [...showFields, 'accept']
                break
              case 'header':
                showFields = ['content']
                break
              default:
                break
            }

            return showFields.includes(input)
          },
        })

        const self = Alpine.store('schema')

        self.update()

        function setValues(item) {
          let newItem = item

          if (newItem.min) newItem.min = _.toInteger(newItem.min)
          if (newItem.max) newItem.max = _.toInteger(newItem.max)
          if (newItem.step) newItem.step = _.toInteger(newItem.step)
          if (newItem.type === 'number')
            newItem.default = _.toInteger(newItem.default)

          if (newItem.type === 'checkbox') {
            let isBoolean =
              newItem.default === 'true' || newItem.default === 'false'

            newItem.default = isBoolean ? JSON.parse(newItem.default) : false
          }

          return newItem
        }
      })
    </script>
  </body>
</html>
